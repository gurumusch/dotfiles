#!/usr/bin/env bash

function get_volume {
   amixer -c 1 sget Master | grep "Mono:" | awk '{print $4}' | sed -E 's/\[([0-9]*)%\]/\1/g'
}

function get_muted {
   amixer -c 1 sget Master | grep "Mono:" | awk '{print $6}' | sed -E 's/\[on\]/on/; s/\[off\]/off/'
}

function dec {
   amixer -c 1 sset Master 10%-
   amixer -c 1 sset Speaker unmute
   amixer -c 1 sset Master unmute
   eww update sd_var_volume="$(get_volume)"
}

function inc {
   amixer -c 1 sset Master 10%+
   amixer -c 1 sset Speaker unmute
   amixer -c 1 sset Master unmute
   eww update sd_var_volume="$(get_volume)"
}

function toggle {
   state=$(get_muted)
   if [[ $state == 'on' ]]; then
      amixer -c1 sset Master mute
   else
      amixer -c1 sset Master unmute
      amixer -c1 sset Speaker unmute
   fi
   #amixer -c 1 sset Speaker toggle
   eww update sd_var_muted="$(get_muted)"
}

if [[ $1 == 'get_volume' ]]; then get_volume; fi
if [[ $1 == 'get_muted' ]]; then get_muted; fi
if [[ $1 == 'dec' ]]; then dec; fi
if [[ $1 == 'inc' ]]; then inc; fi
if [[ $1 == 'toggle' ]]; then toggle; fi
